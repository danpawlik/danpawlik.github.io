<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Create simply script to verify Ansible yaml file | Dan Pawlik blog site</title>
<meta name=keywords content="script"><meta name=description content="Desc Text."><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.b210b30f6d6919fdd4ea762b4c0a1ecbb0b9e321b761143a2b02b57fe9314f8f.css integrity="sha256-shCzD21pGf3U6nYrTAoey7C54yG3YRQ6KwK1f+kxT48=" rel="preload stylesheet" as=style><link rel=icon href=https://danpawlik.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://danpawlik.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://danpawlik.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://danpawlik.github.io/apple-touch-icon.png><link rel=mask-icon href=https://danpawlik.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://danpawlik.github.io/posts/simply-script-for-ansible/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://danpawlik.github.io/posts/simply-script-for-ansible/"><meta property="og:site_name" content="Dan Pawlik blog site"><meta property="og:title" content="Create simply script to verify Ansible yaml file"><meta property="og:description" content="Desc Text."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-17T09:08:04+02:00"><meta property="article:modified_time" content="2025-06-17T09:08:04+02:00"><meta property="article:tag" content="Script"><meta property="og:image" content="https://danpawlik.github.io/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://danpawlik.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Create simply script to verify Ansible yaml file"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://danpawlik.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Create simply script to verify Ansible yaml file","item":"https://danpawlik.github.io/posts/simply-script-for-ansible/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Create simply script to verify Ansible yaml file","name":"Create simply script to verify Ansible yaml file","description":"Desc Text.","keywords":["script"],"articleBody":"Introduction In this blog post I would try to introduce you, how to create a prompt query using Python script to Ollama, that will verify Ansible playbook or role tasks that are in yaml file.\nPre requirements For making this exercise, please make sure you have:\nconfigured properly the required packages - you can read about it blog chapter you have started an LLM container and you know how to start Ollama. All is described in this blog chapter Recreate container To avoid copy-paste or edit the code directly inside the container, I decided to create new container, that would have additional mounts. Also some environment variable are not needed anymore, so let’s remove them too.\n1 2 3 4 5 6 7 8 9 10 11 sudo podman run -itd \\ --net=host \\ --device=/dev/dri \\ -v $(echo $HOME)/.ollama:/root/.ollama:z \\ -v $(echo $HOME)/ai:/root/ai:z \\ -v $(echo $HOME)/RH/ng:/root/ng:z \\ --memory=\"32G\" \\ --name=ipex-llm-inference-cpp-xpu-container \\ -e DEVICE=Arc \\ --shm-size=\"16g\" \\ intelanalytics/ipex-llm-inference-cpp-xpu:latest Where:\n~/ai - is a workdir, where I created a Python script ~/RH - is my workdir used for work. In this dir, I have already cloned project ci-framework (’~/RH/ng/ci-framework') ~/.ollama - is a Ollama workding which is used by the service to store required data, like models. You can create the directories using command:\n1 mkdir -p ~/ai ~/RH ~/.ollama or just remove the volume mount to the container.\nSimply Python script For testing purpose, I created a simple script that takes as an argument a file(s) to be loaded, spars as yaml, and at the end will send a query to Ollam, in which it will claim to analyze the code and optimize it.\nSoon I will try to write a more complicated example, which will make more use of Ollam’s capabilities. For now, you need to understand the basics.\nThe script looks like:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 #!/usr/bin/env python3 import ollama import os import yaml import sys def load_yaml_file(file_path): if not os.path.exists(file_path): print(\"The file does not exists or permissions error!\") sys.exit(1) try: with open(file_path, 'r', encoding=\"utf-8\") as file: return yaml.safe_load(file) except yaml.YAMLError as e: print(f\"Error on parsing file {file_path}: {e}\") sys.exit(1) def main(): if len(sys.argv) \u003c 2: print(\"Can not continue. Please add file to parse as argument\") sys.exit(1) for file_path in sys.argv[1:]: yaml_content = load_yaml_file(file_path) prompt = f\"\"\" Could you analyze the Ansible file and check if it is correct or it can be improved? Here is the YAML: ```yaml {yaml_content} \"\"\" client = ollama.Client() response = client.generate(model=\"codellama:13b\", prompt=prompt) print(\"=== CODELLAMA ANALYSIS ===\") print(response['response']) if __name__ == \"__main__\": main() Script execution preparation As it was mentioned, we need to have the container running. I assume you already have one, so let’s exec to the container and start Ollama server:\nNOTE: All commands below would be executed inside the container\n1 2 3 sudo podman exec -it ipex-llm-inference-cpp-xpu-container bash /llm/scripts/start-ollama.sh The Ollama should be running as a background process, so let’s execute the script now.\nIn my case, I already have a ci-framework project available in ~/ng/ci-framework inside the container. If you don’t have it, just run the command:\n1 git clone https://github.com/openstack-k8s-operators/ci-framework ~/ng/ci-framework Executing script - very simply role file Testing basic simply yaml file that is in ci_setup role.\n1 python3 test-ansible.py /root/ng/ci-framework/roles/ci_setup/tasks/main.yml The Ollama replies (as you see on the screen):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 - name: Load vars tags: - always ansible.builtin.import_tasks: load_vars.yml - name: Install packages tags: - always ansible.builtin.import_tasks: packages.yml - name: Enable repos tags: - always ansible.builtin.import_tasks: repos.yml - name: Create directories tags: - always vars: directory_state: directory ansible.builtin.import_tasks: directories.yml This Ansible playbook imports a number of tasks from other files, and assigns them to different groups based on the `tags` property. The `always` tag is used to indicate that these tasks should always be executed during the playbook run, regardless of whether they are part of the current task or not. The `ansible.builtin.import_tasks` module is used to import tasks from other files. In this case, it imports `load_vars.yml`, `packages.yml`, `repos.yml`, and `directories.yml`. These files contain additional tasks that are executed during the playbook run. The `directory_state` variable is defined in the `Create directories` task, and is used to specify that the directory should be created if it does not already exist. The value of this variable can be modified as needed to control the behavior of the `ansible.builtin.file` module, which is used to create the directory. Overall, this playbook appears to be well-structured and easy to read. It uses Ansible's built-in modules and tags to achieve its goals, and it is a good starting point for any Ansible playbook. The file was very simply, so the summary is ok.\nExecuting script - advanced role file Definitely more advanced tasks are located in reproducer role. Let’s see what summary or code optimalization would suggest using file.\n1 python3 test-ansible.py /root/ng/ci-framework/roles/reproducer/tasks/configure_controller.yml Prompt raise an issue, that the file is not properly closed:\n1 2 This task is defining a number of variables that will be used by the `ntpopenstack_cifmw.yaml [/snippets] The role you are using is not properly closed. You need to add a closing bracket at the endraw %}\", and I believe you are defining a number of variables that will be used by the cifmw.yaml', 'content': \"{% raw %}\\n {% for key, value in _cifmw.yaml', 'target': \"cifmw.yaml'}}\" It is high possible, that the Python yaml library can not parse the yaml with jinja2. Let’s modify the script and read the file as it is, not parse to yaml.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 #!/usr/bin/env python3 import ollama import os import sys def load_file(file_path): if not os.path.exists(file_path): print(\"The file does not exists or permissions error!\") sys.exit(1) try: with open(file_path, 'r', encoding=\"utf-8\") as file: return file.read() except Exception as e: print(f\"Error on parsing file {file_path}: {e}\") sys.exit(1) def main(): if len(sys.argv) \u003c 2: print(\"Can not continue. Please add file to parse as argument\") sys.exit(1) for file_path in sys.argv[1:]: yaml_content = load_file(file_path) prompt = f\"\"\" Could you analyze the Ansible file and check if it is correct or it can be improved? Here is the YAML: ```yaml {yaml_content} \"\"\" client = ollama.Client() response = client.generate(model=\"codellama:13b\", prompt=prompt) print(\"=== CODELLAMA ANALYSIS ===\") print(response['response']) if __name__ == \"__main__\": main() Modification done:\nchanged function name from load_yaml_file to load_file changed function load_file to return string exactly what file contains, without parsing to yaml After few times execution, it always prints some artifacts instead of summary, advice etc.\nSummary For basic Ansible tasks file, summary was ok, but with more advanced file, probably the default limits what are set are not enough to compute the query. I will do another blog post to check if another model would be able to proceed.\n","wordCount":"1219","inLanguage":"en","image":"https://danpawlik.github.io/%3Cimage%20path/url%3E","datePublished":"2025-06-17T09:08:04+02:00","dateModified":"2025-06-17T09:08:04+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://danpawlik.github.io/posts/simply-script-for-ansible/"},"publisher":{"@type":"Organization","name":"Dan Pawlik blog site","logo":{"@type":"ImageObject","url":"https://danpawlik.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://danpawlik.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://danpawlik.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://danpawlik.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://danpawlik.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://danpawlik.github.io title="main page"><span>main page</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://danpawlik.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://danpawlik.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Create simply script to verify Ansible yaml file</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2025-06-17 09:08:04 +0200 CEST'>June 17, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1219 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/simply-script-for-ansible.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#pre-requirements>Pre requirements</a></li><li><a href=#recreate-container>Recreate container</a></li><li><a href=#simply-python-script>Simply Python script</a></li><li><a href=#script-execution-preparation>Script execution preparation</a></li><li><a href=#executing-script---very-simply-role-file>Executing script - very simply role file</a></li><li><a href=#executing-script---advanced-role-file>Executing script - advanced role file</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>In this blog post I would try to introduce you, how to create a prompt query
using Python script to Ollama, that will verify Ansible playbook or role
tasks that are in yaml file.</p><h2 id=pre-requirements>Pre requirements<a hidden class=anchor aria-hidden=true href=#pre-requirements>#</a></h2><p>For making this exercise, please make sure you have:</p><ul><li>configured properly the required packages - you can read about it <a href=https://danpawlik.github.io/posts/intel-npu-driver-disappointment/#looking-for-driver-package>blog chapter</a></li><li>you have started an LLM container and you know how to start Ollama. All is
described in this <a href=https://danpawlik.github.io/posts/using-ollama/#start-ollama-using-container-and-execute-the-python-script>blog chapter</a></li></ul><h2 id=recreate-container>Recreate container<a hidden class=anchor aria-hidden=true href=#recreate-container>#</a></h2><p>To avoid copy-paste or edit the code directly inside the container,
I decided to create new container, that would have additional mounts.
Also some environment variable are not needed anymore, so let&rsquo;s remove them
too.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo podman run -itd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --net<span class=o>=</span>host <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --device<span class=o>=</span>/dev/dri <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=k>$(</span><span class=nb>echo</span> <span class=nv>$HOME</span><span class=k>)</span>/.ollama:/root/.ollama:z <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=k>$(</span><span class=nb>echo</span> <span class=nv>$HOME</span><span class=k>)</span>/ai:/root/ai:z <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v <span class=k>$(</span><span class=nb>echo</span> <span class=nv>$HOME</span><span class=k>)</span>/RH/ng:/root/ng:z <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --memory<span class=o>=</span><span class=s2>&#34;32G&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --name<span class=o>=</span>ipex-llm-inference-cpp-xpu-container <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>DEVICE</span><span class=o>=</span>Arc <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --shm-size<span class=o>=</span><span class=s2>&#34;16g&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    intelanalytics/ipex-llm-inference-cpp-xpu:latest
</span></span></code></pre></td></tr></table></div></div><p>Where:</p><ul><li><code>~/ai</code> - is a workdir, where I created a Python script</li><li><code>~/RH</code> - is my workdir used for work. In this dir, I have already cloned
project <code>ci-framework</code> (&rsquo;~/RH/ng/ci-framework')</li><li><code>~/.ollama</code> - is a Ollama workding which is used by the service to store
required data, like models.</li></ul><p>You can create the directories using command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p ~/ai ~/RH ~/.ollama
</span></span></code></pre></td></tr></table></div></div><p>or just remove the volume mount to the container.</p><h2 id=simply-python-script>Simply Python script<a hidden class=anchor aria-hidden=true href=#simply-python-script>#</a></h2><p>For testing purpose, I created a simple script that takes as an argument
a file(s) to be loaded, spars as yaml, and at the end will send a query
to Ollam, in which it will claim to analyze the code and optimize it.</p><p>Soon I will try to write a more complicated example, which will make more
use of Ollam&rsquo;s capabilities. For now, you need to understand the basics.</p><p>The script looks like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span><span class=lnt id=hl-2-45><a class=lnlinks href=#hl-2-45>45</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ollama</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>yaml</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_yaml_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;The file does not exists or permissions error!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>yaml</span><span class=o>.</span><span class=n>safe_load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>yaml</span><span class=o>.</span><span class=n>YAMLError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error on parsing file </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Can not continue. Please add file to parse as argument&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=n>yaml_content</span> <span class=o>=</span> <span class=n>load_yaml_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Could you analyze the Ansible file and check if it is
</span></span></span><span class=line><span class=cl><span class=s2>    correct or it can be improved?
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Here is the YAML:
</span></span></span><span class=line><span class=cl><span class=s2>    ```yaml
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{</span><span class=n>yaml_content</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>client</span> <span class=o>=</span> <span class=n>ollama</span><span class=o>.</span><span class=n>Client</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;codellama:13b&#34;</span><span class=p>,</span> <span class=n>prompt</span><span class=o>=</span><span class=n>prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== CODELLAMA ANALYSIS ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=p>[</span><span class=s1>&#39;response&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=script-execution-preparation>Script execution preparation<a hidden class=anchor aria-hidden=true href=#script-execution-preparation>#</a></h2><p>As it was mentioned, we need to have the container running.
I assume you already have one, so let&rsquo;s exec to the container and
start Ollama server:</p><p>NOTE: <em>All commands below would be executed inside the container</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo podman <span class=nb>exec</span> -it ipex-llm-inference-cpp-xpu-container bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/llm/scripts/start-ollama.sh
</span></span></code></pre></td></tr></table></div></div><p>The <code>Ollama</code> should be running as a background process, so let&rsquo;s execute
the script now.</p><p>In my case, I already have a <code>ci-framework</code> project available in <code>~/ng/ci-framework</code>
inside the container. If you don&rsquo;t have it, just run the command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone https://github.com/openstack-k8s-operators/ci-framework ~/ng/ci-framework
</span></span></code></pre></td></tr></table></div></div><h2 id=executing-script---very-simply-role-file>Executing script - very simply role file<a hidden class=anchor aria-hidden=true href=#executing-script---very-simply-role-file>#</a></h2><p>Testing basic simply yaml file that is in <code>ci_setup</code> role.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python3 test-ansible.py /root/ng/ci-framework/roles/ci_setup/tasks/main.yml
</span></span></code></pre></td></tr></table></div></div><p><img alt=mainRole loading=lazy src=../../posts/images/01-simply-script-main-role.jpg></p><p>The Ollama replies (as you see on the screen):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl>  <span class=o>-</span> <span class=n>name</span><span class=p>:</span> <span class=n>Load</span> <span class=n>vars</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>import_tasks</span><span class=p>:</span> <span class=n>load_vars</span><span class=o>.</span><span class=n>yml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>name</span><span class=p>:</span> <span class=n>Install</span> <span class=n>packages</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>import_tasks</span><span class=p>:</span> <span class=n>packages</span><span class=o>.</span><span class=n>yml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>name</span><span class=p>:</span> <span class=n>Enable</span> <span class=n>repos</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>import_tasks</span><span class=p>:</span> <span class=n>repos</span><span class=o>.</span><span class=n>yml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>name</span><span class=p>:</span> <span class=n>Create</span> <span class=n>directories</span>
</span></span><span class=line><span class=cl>    <span class=n>tags</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>vars</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>directory_state</span><span class=p>:</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl>    <span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>import_tasks</span><span class=p>:</span> <span class=n>directories</span><span class=o>.</span><span class=n>yml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=n>Ansible</span> <span class=n>playbook</span> <span class=n>imports</span> <span class=n>a</span> <span class=n>number</span> <span class=n>of</span> <span class=n>tasks</span> <span class=n>from</span> <span class=n>other</span> <span class=n>files</span><span class=p>,</span> <span class=ow>and</span> <span class=n>assigns</span>
</span></span><span class=line><span class=cl><span class=n>them</span> <span class=n>to</span> <span class=n>different</span> <span class=n>groups</span> <span class=n>based</span> <span class=n>on</span> <span class=n>the</span> <span class=err>`</span><span class=n>tags</span><span class=err>`</span> <span class=n>property</span><span class=o>.</span> <span class=n>The</span> <span class=err>`</span><span class=n>always</span><span class=err>`</span> <span class=n>tag</span> <span class=n>is</span> <span class=n>used</span>
</span></span><span class=line><span class=cl><span class=n>to</span> <span class=n>indicate</span> <span class=n>that</span> <span class=n>these</span> <span class=n>tasks</span> <span class=n>should</span> <span class=n>always</span> <span class=n>be</span> <span class=n>executed</span> <span class=n>during</span> <span class=n>the</span> <span class=n>playbook</span>
</span></span><span class=line><span class=cl><span class=n>run</span><span class=p>,</span> <span class=n>regardless</span> <span class=n>of</span> <span class=n>whether</span> <span class=n>they</span> <span class=n>are</span> <span class=n>part</span> <span class=n>of</span> <span class=n>the</span> <span class=n>current</span> <span class=n>task</span> <span class=ow>or</span> <span class=ow>not</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=err>`</span><span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>import_tasks</span><span class=err>`</span> <span class=n>module</span> <span class=n>is</span> <span class=n>used</span> <span class=n>to</span> <span class=n>import</span> <span class=n>tasks</span> <span class=n>from</span>
</span></span><span class=line><span class=cl><span class=n>other</span> <span class=n>files</span><span class=o>.</span> <span class=n>In</span> <span class=n>this</span> <span class=k>case</span><span class=p>,</span> <span class=n>it</span> <span class=n>imports</span> <span class=err>`</span><span class=n>load_vars</span><span class=o>.</span><span class=n>yml</span><span class=err>`</span><span class=p>,</span> <span class=err>`</span><span class=n>packages</span><span class=o>.</span><span class=n>yml</span><span class=err>`</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>`</span><span class=n>repos</span><span class=o>.</span><span class=n>yml</span><span class=err>`</span><span class=p>,</span> <span class=ow>and</span> <span class=err>`</span><span class=n>directories</span><span class=o>.</span><span class=n>yml</span><span class=err>`</span><span class=o>.</span> <span class=n>These</span> <span class=n>files</span> <span class=n>contain</span> <span class=n>additional</span> <span class=n>tasks</span>
</span></span><span class=line><span class=cl><span class=n>that</span> <span class=n>are</span> <span class=n>executed</span> <span class=n>during</span> <span class=n>the</span> <span class=n>playbook</span> <span class=n>run</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=err>`</span><span class=n>directory_state</span><span class=err>`</span> <span class=n>variable</span> <span class=n>is</span> <span class=n>defined</span> <span class=ow>in</span> <span class=n>the</span> <span class=err>`</span><span class=n>Create</span> <span class=n>directories</span><span class=err>`</span> <span class=n>task</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=ow>and</span> <span class=n>is</span> <span class=n>used</span> <span class=n>to</span> <span class=n>specify</span> <span class=n>that</span> <span class=n>the</span> <span class=n>directory</span> <span class=n>should</span> <span class=n>be</span> <span class=n>created</span> <span class=k>if</span> <span class=n>it</span> <span class=n>does</span> <span class=ow>not</span>
</span></span><span class=line><span class=cl><span class=n>already</span> <span class=n>exist</span><span class=o>.</span> <span class=n>The</span> <span class=n>value</span> <span class=n>of</span> <span class=n>this</span> <span class=n>variable</span> <span class=n>can</span> <span class=n>be</span> <span class=n>modified</span> <span class=n>as</span> <span class=n>needed</span> <span class=n>to</span>
</span></span><span class=line><span class=cl><span class=n>control</span> <span class=n>the</span> <span class=n>behavior</span> <span class=n>of</span> <span class=n>the</span> <span class=err>`</span><span class=n>ansible</span><span class=o>.</span><span class=n>builtin</span><span class=o>.</span><span class=n>file</span><span class=err>`</span> <span class=n>module</span><span class=p>,</span> <span class=n>which</span> <span class=n>is</span> <span class=n>used</span>
</span></span><span class=line><span class=cl><span class=n>to</span> <span class=n>create</span> <span class=n>the</span> <span class=n>directory</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Overall</span><span class=p>,</span> <span class=n>this</span> <span class=n>playbook</span> <span class=n>appears</span> <span class=n>to</span> <span class=n>be</span> <span class=n>well</span><span class=o>-</span><span class=n>structured</span> <span class=ow>and</span> <span class=n>easy</span> <span class=n>to</span> <span class=n>read</span><span class=o>.</span> <span class=n>It</span> <span class=n>uses</span>
</span></span><span class=line><span class=cl><span class=n>Ansible</span><span class=s1>&#39;s built-in modules and tags to achieve its goals, and it is a good</span>
</span></span><span class=line><span class=cl><span class=n>starting</span> <span class=n>point</span> <span class=k>for</span> <span class=n>any</span> <span class=n>Ansible</span> <span class=n>playbook</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p>The file was very simply, so the summary is ok.</p><h2 id=executing-script---advanced-role-file>Executing script - advanced role file<a hidden class=anchor aria-hidden=true href=#executing-script---advanced-role-file>#</a></h2><p>Definitely more advanced tasks are located in <code>reproducer</code> role.
Let&rsquo;s see what summary or code optimalization would suggest
using <a href=https://github.com/openstack-k8s-operators/ci-framework/blob/5486e254db14394ff723ef91587934af2458d786/roles/reproducer/tasks/configure_controller.yml>file</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python3 test-ansible.py /root/ng/ci-framework/roles/reproducer/tasks/configure_controller.yml
</span></span></code></pre></td></tr></table></div></div><p><img alt=advancedRole loading=lazy src=../../posts/images/02-simply-script-reproducer-role.jpg></p><p>Prompt raise an issue, that the file is not properly closed:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>This</span> <span class=n>task</span> <span class=n>is</span> <span class=n>defining</span> <span class=n>a</span> <span class=n>number</span> <span class=n>of</span> <span class=n>variables</span> <span class=n>that</span> <span class=n>will</span> <span class=n>be</span> <span class=n>used</span> <span class=n>by</span> <span class=n>the</span> <span class=err>`</span><span class=n>ntpopenstack_cifmw</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl>     <span class=p>[</span><span class=o>/</span><span class=n>snippets</span><span class=p>]</span>  <span class=n>The</span> <span class=n>role</span> <span class=n>you</span> <span class=n>are</span> <span class=n>using</span> <span class=n>is</span> <span class=ow>not</span> <span class=n>properly</span> <span class=n>closed</span><span class=o>.</span> <span class=n>You</span> <span class=n>need</span> <span class=n>to</span> <span class=n>add</span> <span class=n>a</span> <span class=n>closing</span> <span class=n>bracket</span> <span class=n>at</span> <span class=n>the</span> <span class=n>endraw</span> <span class=o>%</span><span class=p>}</span><span class=s2>&#34;, and I believe you are defining a number of variables that will be used by the cifmw.yaml&#39;, &#39;content&#39;: &#34;</span><span class=p>{</span><span class=o>%</span> <span class=n>raw</span> <span class=o>%</span><span class=p>}</span>\<span class=n>n</span> <span class=p>{</span><span class=o>%</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>_cifmw</span><span class=o>.</span><span class=n>yaml</span><span class=s1>&#39;, &#39;</span><span class=n>target</span><span class=s1>&#39;: &#34;cifmw.yaml&#39;</span><span class=p>}}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>It is high possible, that the Python yaml library can not parse the <code>yaml</code>
with <code>jinja2</code>. Let&rsquo;s modify the script and read the file
as it is, not parse to yaml.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28>28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29>29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30>30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31>31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32>32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33>33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34>34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35>35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36>36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37>37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38>38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39>39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40>40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41>41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42>42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43>43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44>44</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ollama</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;The file does not exists or permissions error!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error on parsing file </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Can not continue. Please add file to parse as argument&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=n>yaml_content</span> <span class=o>=</span> <span class=n>load_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Could you analyze the Ansible file and check if it is
</span></span></span><span class=line><span class=cl><span class=s2>    correct or it can be improved?
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Here is the YAML:
</span></span></span><span class=line><span class=cl><span class=s2>    ```yaml
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=si>{</span><span class=n>yaml_content</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>client</span> <span class=o>=</span> <span class=n>ollama</span><span class=o>.</span><span class=n>Client</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;codellama:13b&#34;</span><span class=p>,</span> <span class=n>prompt</span><span class=o>=</span><span class=n>prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== CODELLAMA ANALYSIS ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=p>[</span><span class=s1>&#39;response&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Modification done:</p><ul><li>changed function name from <code>load_yaml_file</code> to <code>load_file</code></li><li>changed function <code>load_file</code> to return string exactly what file contains,
without parsing to yaml</li></ul><p>After few times execution, it always prints some artifacts instead of summary,
advice etc.</p><p><img alt=advancedRole loading=lazy src=../../posts/images/03-simply-script-reproducer-role.jpg></p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>For basic Ansible tasks file, summary was ok, but with more advanced file,
probably the default limits what are set are not enough to compute the query.
I will do another blog post to check if another model would be able to proceed.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://danpawlik.github.io/tags/script/>Script</a></li></ul><nav class=paginav><a class=prev href=https://danpawlik.github.io/posts/check-alternative-code-models/><span class=title>« Prev</span><br><span>Check alternative code models</span>
</a><a class=next href=https://danpawlik.github.io/posts/using-ollama/><span class=title>Next »</span><br><span>Using Ollama</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on x" href="https://x.com/intent/tweet/?text=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file&amp;url=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f&amp;hashtags=script"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f&amp;title=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file&amp;summary=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file&amp;source=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f&title=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on whatsapp" href="https://api.whatsapp.com/send?text=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file%20-%20https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on telegram" href="https://telegram.me/share/url?text=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file&amp;url=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Create simply script to verify Ansible yaml file on ycombinator" href="https://news.ycombinator.com/submitlink?t=Create%20simply%20script%20to%20verify%20Ansible%20yaml%20file&u=https%3a%2f%2fdanpawlik.github.io%2fposts%2fsimply-script-for-ansible%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://danpawlik.github.io/>Dan Pawlik blog site</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>